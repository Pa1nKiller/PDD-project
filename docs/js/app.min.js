(()=>{"use strict";const t={};let e=!0,i=(t=500)=>{let i=document.querySelector("body");if(e){let s=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let t=0;t<s.length;t++){s[t].style.paddingRight="0px"}i.style.paddingRight="0px",document.documentElement.classList.remove("lock")}),t),e=!1,setTimeout((function(){e=!0}),t)}},s=(t=500)=>{let i=document.querySelector("body");if(e){let s=document.querySelectorAll("[data-lp]");for(let t=0;t<s.length;t++){s[t].style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px"}i.style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px",document.documentElement.classList.add("lock"),e=!1,setTimeout((function(){e=!0}),t)}};const r=class{constructor(t){this.title=t.title,this.subtitle=t.subtitle,this.text=t.text,this.img=t.img,this.structureHTML=new Array,this.createHTML()}createHTML(){for(let t=0;t<this.subtitle.length;t++)this.structureHTML+='<h3 class="element-animation">'+this.subtitle[t]+"</h3>",this.structureHTML+='<p class="element-animation">'+this.text[t]+"</p>",null!=this.img[t]&&(t+1!=this.subtitle.length?this.structureHTML+='<img class="element-animation" src="'+this.img[t]+'">':this.structureHTML+='<img src="'+this.img[t]+'">')}content(){return{title:this.title,html:this.structureHTML}}};const o=class{constructor(t="default",e,i,s,r,o){this.path=i,this.carHtml=document.createElement("div"),this.carImg=document.createElement("img"),this.count=document.createElement("span"),this.deg=o,this.direction=t,this.carImg.src=this.path,this.carHtml.appendChild(this.carImg),this.carHtml.appendChild(this.count),this.count.classList.add("count"),this.carHtml.classList.add("car"),this.carHtml.style.top=r+"px",this.carHtml.style.left=s+"px",this.carHtml.style.rotate=this.deg+"deg",document.querySelector(".intersection").appendChild(this.carHtml);let n=document.querySelector(".intersection");n=window.getComputedStyle(n),this.intersectionWidth=this.removePX(n.getPropertyValue("width"))+60,this.intersectionHeight=this.removePX(n.getPropertyValue("height"))+60;let c=window.getComputedStyle(this.carHtml);this.carY=this.removePX(c.getPropertyValue("top")),this.carX=this.removePX(c.getPropertyValue("left")),this.intersectionCenter=window.getComputedStyle(e),Number(),this.Il=this.removePX(this.intersectionCenter.getPropertyValue("left")),this.It=this.removePX(this.intersectionCenter.getPropertyValue("top")),this.Iw=this.removePX(this.intersectionCenter.getPropertyValue("width")),this.Ih=this.removePX(this.intersectionCenter.getPropertyValue("height")),this.points(),this.clickCarHtml()}points(){let t=document.createElement("div");this.centerPointY=this.It+this.Ih/2,this.centerPointX=this.Il+this.Iw/2,t.classList.add("centerPoint"),t.style.top=this.centerPointY+"px",t.style.left=this.centerPointX+"px",document.querySelector(".intersection").appendChild(t)}moveTop(){if(this.centerPointY<this.carY&&this.centerPointX<this.carX){let t=()=>{setTimeout((()=>{this.carY--,this.carHtml.style.top=this.carY+"px",this.carY<this.intersectionHeight&&t()}),2)};t()}else if(this.centerPointY>this.carY&&this.centerPointX>this.carX){let t=()=>{setTimeout((()=>{this.carX++,this.carHtml.style.left=this.carX+"px",this.carX<this.intersectionWidth&&t()}),2)};t()}else if(this.centerPointY>this.carY&&this.centerPointX>this.carX){let t=()=>{setTimeout((()=>{this.carY++,this.carHtml.style.top=this.carY+"px",this.carY>this.intersectionHeight&&t()}),2)};t()}else if(this.centerPointY>this.carY&&this.centerPointX<this.carX){let t=()=>{setTimeout((()=>{this.carX--,this.carHtml.style.left=this.carX+"px",this.carX>-220&&t()}),2)};t()}}removePX(t){return Number(t.substring(0,t.length-2))}move(){this.moveDeg()}smoothRotate(t,e,i){let s=Number(this.carHtml.style.rotate.substring(0,this.carHtml.style.rotate.length-3)),r=null,o=n=>{r||(r=n);const c=n-r,l=function(t,e,i,s){if((t/=s/2)<1)return i/2*t*t*t+e;return i/2*((t-=2)*t*t+2)+e}(c,s,e,i);if(l+1>s+e&&l-1<s+e)return console.log("1"),this.direction="default",this.deg=l,void this.moveDeg();t.style.rotate=`${l}deg`,c<i&&requestAnimationFrame(o)};requestAnimationFrame(o)}clickCarHtml(){this.carHtml.addEventListener("click",(()=>{for(let t=0;t<window.cars.length;t++){if(window.cars[t]==this)return}window.cars.push(this),this.carHtml.querySelector(".count").innerHTML=window.cars.length,3==window.cars.length&&window.start()}))}moveDeg(){console.log("ТУТ"),this.deg>89&&this.deg<91&&this.plusX(),this.deg>179&&this.deg<181&&this.plusY(),this.deg>-89&&this.deg<-91&&this.minusX(),this.deg>-1&&this.deg<1&&this.minusY()}plusX(){if("default"==this.direction){let t=()=>{setTimeout((()=>{this.carX++,this.carHtml.style.left=this.carX+"px",this.carX<this.intersectionWidth&&t()}),2)};t()}else{let t=()=>{setTimeout((()=>{this.carX++,this.carHtml.style.left=this.carX+"px",this.carX-20<this.centerPointX?t():this.smoothRotate(this.carHtml,-90,1e3)}),2)};t()}}plusY(){let t=()=>{setTimeout((()=>{this.carY++,this.carHtml.style.top=this.carY+"px",this.carY<this.intersectionHeight&&t()}),2)};t()}minusX(){let t=()=>{setTimeout((()=>{this.carX--,this.carHtml.style.left=this.carX+"px",this.carX>-220&&t()}),2)};t()}minusY(){let t=()=>{setTimeout((()=>{this.carY--,this.carHtml.style.top=this.carY+"px",this.carY>-220&&t()}),2)};t()}},n=JSON.parse('{"generalProvisions":{"general":{"title":"Общие положения","subtitle":["1. Дорога и Пешеходы","2. Правило правой руки","3. Светофоры и Знаки","4. Скорость и Дистанция","5. Алкоголь и Наркотики","6. Сотовые телефоны","7. Другие Участники Движения"],"img":["./img/theory/generalProvisions/1/1.jpg","./img/theory/generalProvisions/1/2.jpg","./img/theory/generalProvisions/1/3.jpg","./img/theory/generalProvisions/1/4.jpg","./img/theory/generalProvisions/1/5.jpg","./img/theory/generalProvisions/1/6.jpg","./img/theory/generalProvisions/1/7.jpg"],"text":[["Дорога - это не просто полоса асфальта. Это место, где каждый участник движения должен соблюдать правила и уважать друг друга.","Пешеходы - наши самые уязвимые участники. Помни, что они всегда имеют преимущество на пешеходных переходах."],["В большинстве стран движение на дороге праворульное. Это означает, что при пересечении других транспортных средств, уступай дорогу тем, кто едет справа."],["Подчиняйтесь светофорам и дорожным знакам. Они указывают, когда можно двигаться и когда нужно остановиться."],["Соблюдай разумную скорость и безопасное расстояние между автомобилями. Это позволяет избежать аварий."],["Никогда не управляй транспортным средством, находясь под воздействием алкоголя или наркотиков. Это опасно и незаконно."],["Перед использованием сотового телефона остановись в безопасном месте. Внимание на дороге — твоя первоочередная задача."],["Помни, что на дороге есть много разных участников, включая велосипедистов, мотоциклистов и пешеходов. Уважай их права и будь осторожен."]]},"generalTwo":{"title":"Общие обязанности водителей","subtitle":["1. Сосредоточенность и Безотвлекаемость","2. Скоростной Режим","3. Передача Приоритета","4. Наличие документов","5. Уступать Пешеходам"],"img":["./img/theory/generalProvisions/2/1.jpg",null,"./img/theory/generalProvisions/2/2.jpg","./img/theory/generalProvisions/2/3.jpg","./img/theory/generalProvisions/2/4.jpg"],"text":[["Внимание на дороге - главное правило. Избегайте отвлекающих действий, таких как разговоры по телефону."],["Уважайте ограничения скорости. Не превышайте их, чтобы обеспечить безопасность всех на дороге."],["Правильно уступайте дорогу согласно правилам. Помните о приоритетах."],["Водитель транспортного средства обязан иметь при себе удостоверение и по требованию сотрудников полиции передавать им, для проверки."],["Пешеходы всегда имеют преимущество на пешеходных переходах. Уступайте дорогу им."],["Перед использованием сотового телефона остановись в безопасном месте. Внимание на дороге — твоя первоочередная задача."],["Помни, что на дороге есть много разных участников, включая велосипедистов, мотоциклистов и пешеходов. Уважай их права и будь осторожен."]]},"generalThree":{"title":"Применение специальных сигналов","subtitle":["1. Специальные сигналы","2. Сирена и Мигающие Маячки","3. Уступите Дорогу","4. Будьте Осторожны"],"img":["./img/theory/generalProvisions/3/1.jpg","./img/theory/generalProvisions/3/2.jpg","./img/theory/generalProvisions/3/3.jpg","./img/theory/generalProvisions/3/4.jpg"],"text":[["Специальные сигналы - это средство, которое используется служебными и аварийными транспортными средствами для обозначения их приоритета на дороге."],["Специальные сигналы обычно включают сирену и мигающие маячки. Это предупреждает других участников движения о неотложности их задачи."],["Когда вы видите служебное аварийное транспортное средство с включенными специальными сигналами, вы должны уступить дорогу и пропустить его."],["Водители должны быть особенно осторожными, когда видят транспортное средство с включенными специальными сигналами. Это может быть связано с неотложной медицинской помощью, пожаром или другой аварией. Важно помнить, что специальные сигналы используются для обеспечения безопасности и сохранения жизней. Уступайте дорогу и будьте осторожными, когда видите транспортное средство с включенными специальными сигналами на дороге."]]}},"roadSigns":{"priority":{"title":"Знаки приоритета","subtitle":["1. Знак \\"Уступите дорогу\\"","2. Знак \\"Главная дорога\\"","3. Знак \\"Пешеходный переход\\"","4. Знак \\"Велосипедисты\\"","5. Знак \\"Железнодорожный переезд\\"","6. Знак \\"Однопроходная дорога\\"","7. Знак \\"Конец полосы\\"","8. Знак \\"Пересечение с трамвайными путями\\"","9. Знак \\"Преимущество встречного движения\\"","10. Знак \\"Двустороннее движение\\""],"img":["./img/theory/roadSigns/1/1.jpg","./img/theory/roadSigns/1/2.jpg","./img/theory/roadSigns/1/3.jpg","./img/theory/roadSigns/1/4.jpg","./img/theory/roadSigns/1/5.jpg","./img/theory/roadSigns/1/6.jpg","./img/theory/roadSigns/1/7.jpg","./img/theory/roadSigns/1/8.jpg","./img/theory/roadSigns/1/9.jpg","./img/theory/roadSigns/1/10.jpg"],"text":[["Знак \\"Уступите дорогу\\" указывает, что вы должны уступить дорогу другим участникам движения."],["Знак \\"Главная дорога\\" показывает, что вы находитесь на главной дороге и имеете приоритет перед въезжающими с боковых дорог."],["Знак \\"Пешеходный переход\\" указывает на место, где пешеходы имеют приоритет при пересечении дороги."],["Знак \\"Велосипедисты\\" предупреждает о наличии велосипедной дорожки и обязывает уступить дорогу велосипедистам."],["Знак \\"Железнодорожный переезд\\" указывает на приближение к железнодорожным путям и обязывает уступить дорогу поездам."],["Знак \\"Однопроходная дорога\\" указывает, что дорога однопроходная, и вы должны уступить дорогу встречным транспортным средствам."],["Знак \\"Конец полосы\\" указывает на конец участка средней полосы и переход во владение встречного направления."],["Знак \\"Пересечение с трамвайными путями\\" предупреждает о наличии трамвайных путей и обязывает уступить дорогу трамваям."],["Знак \\"Преимущество встречного движения\\" указывает на приоритет движения водителей по встречной полосе и обязывает уступить дорогу встречному движению."],["Знак \\"Двустороннее движение\\" показывает, что дорога двусторонняя и участники движения могут двигаться в обоих направлениях."]]},"forbidding":{"title":"Запрещающие знаки","subtitle":["1. Сосредоточенность и Безотвлекаемость","2. Скоростной Режим","3. Передача Приоритета","4. Наличие документов","5. Уступать Пешеходам"],"img":["./img/theory/roadSigns/2/1.jpg","./img/theory/roadSigns/2/2.jpg","./img/theory/roadSigns/2/3.jpg","./img/theory/roadSigns/2/4.jpg","./img/theory/roadSigns/2/5.jpg","./img/theory/roadSigns/2/6.jpg","./img/theory/roadSigns/2/7.jpg","./img/theory/roadSigns/2/8.jpg","./img/theory/roadSigns/2/9.jpg","./img/theory/roadSigns/2/10.jpg"],"text":[["Внимание на дороге - главное правило. Избегайте отвлекающих действий, таких как разговоры по телефону."],["Уважайте ограничения скорости. Не превышайте их, чтобы обеспечить безопасность всех на дороге."],["Правильно уступайте дорогу согласно правилам. Помните о приоритетах."],["Водитель транспортного средства обязан иметь при себе удостоверение и по требованию сотрудников полиции передавать им, для проверки."],["Пешеходы всегда имеют преимущество на пешеходных переходах. Уступайте дорогу им."],["Перед использованием сотового телефона остановись в безопасном месте. Внимание на дороге — твоя первоочередная задача."],["Помни, что на дороге есть много разных участников, включая велосипедистов, мотоциклистов и пешеходов. Уважай их права и будь осторожен."]]},"prescriptive":{"title":"Предписывающие знаки","subtitle":["1. Знак \\"Двигаться прямо\\"","2. Знак \\"Поворот направо\\"","3. Знак \\"Поворот налево\\"","4. Знак \\"Двигаться в обратном направлении\\"","5. Знак \\"Объезд препятствия справа\\""],"img":["./img/theory/roadSigns/3/1.jpg","./img/theory/roadSigns/3/2.jpg","./img/theory/roadSigns/3/3.jpg","./img/theory/roadSigns/3/4.jpg","./img/theory/roadSigns/3/5.jpg","./img/theory/roadSigns/3/6.jpg"],"text":[["Знак с изображением стрелки, указывающей вперед, предписывает двигаться прямо, не поворачивая."],["Знак с изображением стрелки, указывающей направо, предписывает совершить правый поворот."],["Знак с изображением стрелки, указывающей налево, предписывает совершить левый поворот."],["Знак с изображением двух стрелок, указывающих в разные стороны, предписывает двигаться в обратном направлении."],["Знак указывает, что объезд различного рода препятствий на проезжей части разрешается со стороны, указанной стрелкой."],["Знак указывает, что движение организовано по кругу в направлении стрелок."]]}}}');t.mousePrlx=new class{constructor(t,e=null){if(this.config=Object.assign({init:!0,logging:!0},t),this.config.init){const t=document.querySelectorAll("[data-prlx-mouse]");t.length?(this.paralaxMouseInit(t),this.setLogging(`Проснулся, слежу за объектами: (${t.length})`)):this.setLogging("Нет ни одного объекта. Сплю...zzZZZzZZz...")}}paralaxMouseInit(t){t.forEach((t=>{const e=t.closest("[data-prlx-mouse-wrapper]"),i=t.dataset.prlxCx?+t.dataset.prlxCx:100,s=t.dataset.prlxCy?+t.dataset.prlxCy:100,r=t.hasAttribute("data-prlx-dxr")?-1:1,o=t.hasAttribute("data-prlx-dyr")?-1:1,n=t.dataset.prlxA?+t.dataset.prlxA:50;let c=0,l=0,a=0,h=0;function g(e=window){e.addEventListener("mousemove",(function(e){const i=t.getBoundingClientRect().top+window.scrollY;if(i>=window.scrollY||i+t.offsetHeight>=window.scrollY){const t=window.innerWidth,i=window.innerHeight,s=e.clientX-t/2,r=e.clientY-i/2;a=s/t*100,h=r/i*100}}))}!function e(){c+=(a-c)*n/1e3,l+=(h-l)*n/1e3,t.style.cssText=`transform: translate3D(${r*c/(i/10)}%,${o*l/(s/10)}%,0);`,requestAnimationFrame(e)}(),e?g(e):g()}))}setLogging(t){this.config.logging&&function(t){setTimeout((()=>{window.FLS&&console.log(t)}),0)}(`[PRLX Mouse]: ${t}`)}}({});let c=!1;function l(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add("element-show")}))}function a(t){var e=t.split(".");let i=n[e[0]],s=new r(i[e[1]]),o=document.querySelector(".theory__container-content"),c=s.content();o.querySelector("h2").innerHTML=c.title;let a=o.querySelector(".theory__content");a.innerHTML=c.html;let h=new IntersectionObserver(l,{threshold:[.3]}),g=document.querySelectorAll(".element-animation");for(let t of g)h.observe(t);let d,m=speechSynthesis.getVoices();speechSynthesis.onvoiceschanged=()=>{m=speechSynthesis.getVoices(),d=m.find((t=>"Google русский"===t.name)),document.querySelector("#voice").addEventListener("click",S),window.addEventListener("keydown",w)};const u="play",p="pause",y="resume";speechSynthesis.cancel(),document.querySelector("#voice").className=u;let S=({target:t})=>{switch(t=t.parentNode,console.log(t),t.className){case u:speechSynthesis.cancel();const{textContent:e}=a;console.log("asd"),e.split(/[.,]+/).forEach((e=>{const i=e.trim();if(console.log(i),i){const i=function(t,e){const i=new SpeechSynthesisUtterance(e);return i.voice=d,i.lang=d.lang,i.volume=1,i.rate=1.1,i.pitch=.85,i.onstart=()=>{console.log("Started"),t.className=p},i.onend=()=>{console.log("Finished"),t.className=u},i.onerror=t=>console.error(t),i}(t,e);speechSynthesis.speak(i)}}));break;case p:t.className=y,speechSynthesis.pause();break;case y:t.className=p,speechSynthesis.resume()}},w=({code:t})=>{if("Escape"===t)return speechSynthesis.cancel()}}setTimeout((()=>{if(c){let t=new Event("windowScroll");window.addEventListener("scroll",(function(e){document.dispatchEvent(t)}))}}),0),window.FLS=!0,function(t){let e=new Image;e.onload=e.onerror=function(){t(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(t){let e=!0===t?"webp":"no-webp";document.documentElement.classList.add(e)})),document.addEventListener("DOMContentLoaded",(()=>{h(),a("generalProvisions.general")}));let h=()=>{let t=document.querySelector(".sidebar"),e=document.querySelector(".sidebar-icon"),i=t.querySelectorAll(".sidebar__item"),s=t.querySelectorAll(".sidebar__icon");s.forEach((t=>{let e=t.parentNode.querySelector(".sidebar__submenu");t.addEventListener("mouseover",(t=>{!function(t){if(!t)return;s.forEach((t=>{let e=t.parentNode.querySelector(".sidebar__submenu");e.classList.contains("hover")&&e.classList.remove("hover")}))}(t),e.classList.add("hover"),document.addEventListener("click",(()=>{e.classList.remove("hover")}))}))})),i.forEach((t=>{let e=t.querySelector("p"),s=t.querySelector(".sidebar__submenu"),r=t.querySelector("svg");e.addEventListener("click",(t=>{!function(t,e){if(!t)return;i.forEach((e=>{let i=e.querySelector(".sidebar__submenu");i!=t&&i.classList.contains("open")&&(e.querySelector("svg").style.rotate="0deg",i.classList.remove("open"))})),t.classList.contains("open")?(t.classList.remove("open"),e.style.rotate="0deg"):(t.classList.add("open"),e.style.rotate="90deg")}(s,r)})),s.querySelectorAll("button").forEach((t=>{t.addEventListener("click",(()=>{a(t.value)}))}))}));e.addEventListener("click",(()=>{t.classList.toggle("open");document.querySelectorAll("#rect").forEach((t=>{t.classList.toggle("is-visible")})),i.forEach((t=>{let e=t.querySelector(".sidebar__submenu");e.classList.contains("open")&&(t.querySelector("svg").style.rotate="0deg",e.classList.remove("open"))}))}))};window.createTestWindow=()=>{window.cars=[];let t=document.createElement("div");t.classList.add("intersectionCenter");document.querySelector(".intersection").appendChild(t),new o("left",t,"./img/tests/cars/y-car.png",100,340,90),new o("default",t,"./img/tests/cars/y-car.png",400,340,90),new o("right",t,"./img/tests/cars/y-car.png",650,500,0)},window.start=()=>{for(let t=0;t<window.cars.length;t++)setTimeout((()=>{const e=window.cars[t];console.log(e),e.move()}),1300*t)},document.querySelector(".icon-menu")&&document.addEventListener("click",(function(t){e&&t.target.closest(".icon-menu")&&(((t=500)=>{document.documentElement.classList.contains("lock")?i(t):s(t)})(),document.documentElement.classList.toggle("menu-open"))}))})();